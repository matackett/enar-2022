---
title: "All about you!"
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
    css: "css/app-style.css"
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(tidyverse)
library(tidyverse)
library(googlesheets4)
library(viridis)
library(waffle)

# remove authorization from googlesheet
gs4_deauth()

tutorial_options(
  # code running in exercise times out after 30 seconds
  exercise.timelimit = 30, 
  )

# hide non-exercise code chunks
knitr::opts_chunk$set(echo = FALSE)

# set ggplot options 

theme_set(theme_bw())
scale_colour_continuous <- scale_colour_viridis_c
scale_colour_discrete   <- scale_colour_viridis_d
scale_colour_binned     <- scale_colour_viridis_b

# read in survey responses
responses <- read_sheet("https://docs.google.com/spreadsheets/d/12TImpxFxdObvzjCVgQK6paPp0AxgN-1lSGg7CKfvCUM/edit?usp=sharing")

# prep data 
responses <- responses %>%
  select(-Timestamp) %>%
  rename(school_level = `Are you currently in high school or undergraduate?`,
         school_format = `Are you primarily attending school in person or online?`, 
         device_school = `About what percentage of your waking hours do you spend using an electronic device for something related to school? This can include attending classes, studying, homework, club meetings, etc.`, 
         device_leisure = `About what percentage of your waking hours do you spend on an electronic device for leisure activities?`, 
         social_media = `What type of social media do you use? Select all that apply.`)
```

## Introduction 

Welcome! In this tutorial, we'll learn R functions that can help us wrangle, summarize, and visualize your survey responses and learn a little more about you! 

### Packages

We'll use the **tidyverse**, "an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures.” 

Use the code below to load the **tidyverse**! 

```{r load-packages, exercise = TRUE}
library(tidyverse)
```

## Data

### Your survey responses 

The data frame `responses` contains your responses to the [survey](https://forms.gle/Txz92ytAmngd5TZy6) you took during this workshop. 

Here is the codebook for `responses`:

- `school_level`: Current school level (High School or Undergraduate)
- `school_format`: How you're primarily attending school right now (In person or Online)
- `device_school`: Percentage of waking hours spent using electronic devices for school 
- `device_leisure`: Percentage of waking hours spent using electronic devices for leisure activities
- `social_media`: Which social media platforms you typically use

### Let's take look at the data

We can use the `slice` function to view the first 5 rows of the data set. 

```{r view-data, exercise = TRUE}
responses %>%
  slice(1:5)
```

## School

### School level

How many students are currently in high school versus college undergraduates? 

Let's find out! [INSERT TEXT ABOUT GGPLOT!]

Run the code below to make a bar plot of `school_level`. 

```{r hs-undergrad, exercise  = TRUE}
ggplot(data = responses, aes(x = school_level)) +
  geom_bar() 
```

### Customize the plot

We can customize our plot by adding labels and changing the color of the bars. 

- To add labels, we'll use the `labs()` function. 
- To change the color of the bars, we'll add `fill = "color-name"` in `geom_bar()`. For example, if we want to make the bars blue, we can add `fill = "blue"` in `geom_bar()`. 

Fill in the code below to change the color of the bars and add a title to the plot. If you need some inspiration, [click here](https://www.r-graph-gallery.com/42-colors-names.html) for a list of colors.

```{r hs-undergrad-2, exercise = TRUE}
ggplot(data = responses, aes(x = school_level)) +
  geom_bar(fill = "___") + 
  labs(x = "School Level", 
       title = "___")
```

### Your Turn! 

Are students in this workshop primarily attending school in person or online? 

Make a bar plot of `school_format`, and customize it by adding labels and changing the color of the bars. 

```{r hs-undergrad-3, exercise = T}
# make bar plot of school_format and customize it!

```


- Make a stacked or side-by-side bar chart?


## Electronic devices

### Percentage of time on school activities vs leisure activities


```{r time-on-device, exercise = TRUE}
ggplot(data = responses, aes(x = device_school, y = device_leisure)) +
  geom_point() + 
  labs(x = "% for school", y = "% for leisure", 
       title = "Percent electronic device usage for school vs. leisure")
```

### Does this differ for high school or undergraduate students?

- Add color to the plot 

```{r time-on-device-2, exercise = TRUE}
ggplot(data = responses, aes(x = device_school, y = device_leisure, color = school_level)) +
  geom_point() + 
  labs(x = "% for school", y = "% for leisure", 
       title = "Percent electronic device usage for school vs. leisure",
       subtitle  = "by School Level")
```


### Does this differ for students taking classes in person or online?

They will fill in the code themselves

```{r time-on-device-3, exercise = TRUE}
ggplot(data = responses, aes(x = device_school, y = device_leisure, color = school_format)) +
  geom_point() + 
  labs(x = "% for school", y = "% for leisure", 
       title = "Percent electronic device usage for school vs. leisure",
       subtitle  = "In person vs. online school") 
```


## Social media

Let's see how many people use facebook. We'll use `str_detect` to do so. It will create a logical variable - true/false for 

### make a facebook variable

```{r facebook, exercise = TRUE}
responses <- responses %>%
  mutate(facebook  = str_detect(social_media, "Facebook"))
```

```{r facebook-slice, exercise = TRUE}
responses %>%
  slice(1:10)
```


### plot it


```{r facebook-count, exercise = TRUE, exercise.setup = "facebook"}
responses %>%
  count(facebook)
```

Make a waffle plot. 

```{r facebook-plot, exercise = TRUE, exercise.setup = "facebook"}
library(waffle)
responses %>%
  count(facebook) %>%
  ggplot(aes(fill = facebook, values = n)) +
  geom_waffle(color = "white") +
  theme_enhance_waffle() +
  coord_equal() + 
  theme(axis.ticks = element_blank())
```


### Let's try it for Instagram

## Learn more about R!

- last page on resources to learn more about R?




