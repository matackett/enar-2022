---
title: "All about you!"
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
    css: "css/app-style.css"
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(tidyverse)
library(tidyverse)
library(googlesheets4)
library(viridis)
library(waffle)

# remove authorization from googlesheet
gs4_deauth()

tutorial_options(
  # code running in exercise times out after 30 seconds
  exercise.timelimit = 30, 
  )

# hide non-exercise code chunks
knitr::opts_chunk$set(echo = FALSE)

# set ggplot options 

theme_set(theme_bw())
scale_colour_continuous <- scale_colour_viridis_c
scale_colour_discrete   <- scale_colour_viridis_d
scale_colour_binned     <- scale_colour_viridis_b

# read in survey responses
responses <- read_sheet("https://docs.google.com/spreadsheets/d/12TImpxFxdObvzjCVgQK6paPp0AxgN-1lSGg7CKfvCUM/edit?usp=sharing")

# prep data 
responses <- responses %>%
  select(-Timestamp) %>%
  rename(school_level = `Are you currently in high school or undergraduate?`,
         school_format = `Are you primarily attending school in person or online?`, 
         device_school = `About what percentage of your waking hours do you spend using an electronic device for something related to school? This can include attending classes, studying, homework, club meetings, etc.`, 
         device_leisure = `About what percentage of your waking hours do you spend on an electronic device for leisure activities?`, 
         social_media = `What type of social media do you use? Select all that apply.`, 
         region = `What region do you live in?`)
```

## Introduction 

Welcome! In this tutorial, we'll learn R functions that can help us wrangle, summarize, and visualize your survey responses and learn a little more about you! 

### Packages

We'll use the **tidyverse**, "an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures.” 

Use the code below to load the **tidyverse**! 

```{r load-packages, exercise = TRUE}
library(tidyverse)
```

## Data

### Your survey responses 

The data frame `responses` contains your responses to the [survey](https://forms.gle/Txz92ytAmngd5TZy6) you took during this workshop. 

Here is the codebook for `responses`:

- `school_level`: High School or Undergraduate
- `school_format`: How you're primarily attending school right now (In person or Online)
- `device_school`: Percentage of waking hours spent using electronic devices for school 
- `device_leisure`: Percentage of waking hours spent using electronic devices for leisure activities
- `social_media`: Which social media platforms you typically use
- `region`: Northeast, South, Midwest, West

### Let's take look at the data

We can use the `slice` function to view the first 5 rows of the data set. 

```{r view-data, exercise = TRUE}
responses %>%
  slice(1:5)
```

## Who's here?

### School level

How many students are currently in high school versus college undergraduates? 

Let's find out! [INSERT TEXT ABOUT GGPLOT! including something about aesthetics]

Run the code below to make a bar plot of `school_level`. 

```{r hs-undergrad, exercise  = TRUE}
ggplot(data = responses, aes(x = school_level)) +
  geom_bar() 
```

### Customize the plot

We can customize our plot by adding labels and changing the color of the bars. 

- To add labels, we'll use the `labs()` function. 
- To change the color of the bars, we'll add `fill = "color-name"` in `geom_bar()`. For example, if we want to make the bars blue, we can add `fill = "blue"` in `geom_bar()`. 

Fill in the code below to change the color of the bars and add a title to the plot. If you need some inspiration, [click here](https://www.r-graph-gallery.com/42-colors-names.html) for a list of colors.

```{r hs-undergrad-2, exercise = TRUE}
ggplot(data = responses, aes(x = school_level)) +
  geom_bar(fill = "___") + 
  labs(title = "___")
```

### Your Turn! 

In which regions do the students in this workshop primarily live? 

Make a bar plot of `region`, and customize it by adding labels and changing the color of the bars. 

```{r region-plot, exercise = T}
# make bar plot of region and customize it!

```


## Electronic devices

What's the relationship between the percentage of time you use an electronic device for school versus for leisure activities in your free time? 

Let's make a scatterplot to find out!

### `device_school` versus `device_leisure`

We can use `geom_point()` to make scatterplots in `ggplot`. 

Run the code below to make a scatterplot of time you use electronic devices for school versus leisure. 

```{r time-on-device, exercise = TRUE}
ggplot(data = responses, aes(x = device_school, y = device_leisure)) +
  geom_point()
```

### `device_school` versus `device_leisure` by `school_level`

Does the relationship between `device_school` and `device_leisure` differ for high school and undergraduate students?

To find out, we can add `color = group_var` to the `aes`thetic, where `group_var` is the variable we want to color by. For example, if we want to color by region, we can add `color = region` in `aes()`. 

Fill in the code to color the points on the scatterplot by `school_level`. Notice that we've also added a subtitle to the plot.

```{r time-on-device-2, exercise = TRUE}
ggplot(data = responses, aes(x = device_school, y = device_leisure, color = ___)) +
  geom_point()
```

### Add labels

Fill in the code below to make the scatterplot with axis labels and a title! 

```{r time-on-device-3, exercise = TRUE}
ggplot(data = responses, aes(x = ___, y = ___, color = school_level)) +
  geom_point() +
  labs(x = "___", 
      y = "___", 
      title = "___")
```

### Your turn! 

Does the relationship between device usage for school versus leisure activities differ for students attending school in person versus online? 

To find out, make a scatterplot of `device_school` versus `device_lesiure` with the color based on `school_format`. 

```{r time-on-device-4, exercise = TRUE}
# add code for scatterplot!

```

## Facebook

Do a majority of students here use Facebook? 

We can use the `social_media` variable to answer help answer this question. Let's take a look at this variable using the `select` function.

```{r facebook-1, exercise = TRUE}
responses %>%
  select(social_media)
```

### Use `str_detect` to identify Facebook users

Respondents could select multiple social media platform, so we need a way to figure out whether Facebook is included in their answer. 

To do so, we'll use the `str_detect` and `mutate` functions  to create a new variable identifying whether the respondent uses Facebook. 

- `str_detect`: returns the value **TRUE** if "Facebook" is included in `social_media` and **FALSE** otherwise.
- `mutate`: Add the new variable to the data set

Run the code below to create the variable `facebook`. 

```{r facebook-2, exercise = TRUE}
responses <- responses %>%
  mutate(facebook  = str_detect(social_media, "Facebook"))
```

Now let's take a look at the data. 

```{r facebook-3, exercise = TRUE, exercise.setup = "facebook-2"}
responses %>%
  select(social_media, facebook)
```

### Visualize `facebook`

Make a bar plot to visualize `facebook`. Customize your plot using 

- `fill = "blue"` in `geom_bar()` to change the color of the bars. 
- `color = "green" in `geom_bar()` to change the line colors
- `labs(title = "Your titl")` to add a title to the plot

```{r facebook-plot, exercise = TRUE, exercise.setup = "facebook-2"}
# make a bar plot of Facebook

```

## Your turn! 

Choose another social media platform in from the survey and visualize the responses!

You can choose from 

- "Instagram" 
- "Twitter"
- "Snapchat"
- "Other"
- "None/ I don't use social media"

### Make a new variable

Fill in the code below to use the `str_detect` and `mutate` functions to create a new variable. 

```{r social-media, exercise = TRUE, exercise.setup = "facebook-2"}
responses <- ___ %>%
  ___(str_detect(___, "___"))
```

Take a look at your new variable

```{r social-media-2, exercise = TRUE, exercise.setup = "facebook-2"}
___ %>%
  select(social_media, ___)
```

### Visualize it! 

```{r social-media-3, exercise = TRUE, exercise.setup = "facebook-2"}
# make a bar plot of your social media variable

```

## Learn more!

Below are a few resources to keep learning more about R and the tidyverse!

- [R for Data Science](https://r4ds.had.co.nz/)
- [RStudio Primers](https://rstudio.cloud/learn/primers)
- [tidyverse.org](https://www.tidyverse.org/)



